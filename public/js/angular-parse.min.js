(function(){var a,b,c={}.hasOwnProperty,d=function(a,b){return function(){return a.apply(b,arguments)}},e=[].slice,f=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b=angular.module("Parse",[]),a={},b.factory("persist",["$q","$window",function(a,b){var d,e;return e=b.localStorage,d={get:function(a){var b,c,d,f;for(angular.isArray(a)||(a=[a]),c={},d=0,f=a.length;f>d;d++)b=a[d],c[b]=e.key(b)?e.getItem(b):void 0;return c},set:function(a){var b,d;for(b in a)c.call(a,b)&&(d=a[b],e.setItem(b,d));return!0},remove:function(a){var b,c,d;for(angular.isArray(a)||(a=[a]),c=0,d=a.length;d>c;c++)b=a[c],localStorage.removeItem(b);return!0}}}]),b.factory("ParseUtils",["$http","$window",function(b,c){var d;return d={BaseUrl:"https://api.parse.com/1",_request:function(d,e,f,g){var h,i,j,k;return angular.isArray(e)?(j=e[0],i=e[1],e=""+j.pathBase()+"/"+i):e.className?e=""+e.pathBase():e.objectId&&(null!=(k=e.constructor)?k.className:void 0)&&(e=""+e.constructor.pathBase()+"/"+e.objectId),h={"X-Parse-Application-Id":a.applicationId,"X-Parse-REST-API-KEY":a.apiKey,"Content-Type":"application/json"},c.localStorage.key("PARSE_SESSION_TOKEN")&&(h["X-Parse-Session-Token"]=c.localStorage.getItem("PARSE_SESSION_TOKEN")),b({method:d,url:this.BaseUrl+e,data:f,params:g,headers:h})},func:function(a){return function(b){return d.callFunction(a,b)}},callFunction:function(a,b){return d._request("POST","/functions/"+a,b).then(function(a){return a.data.result})}}}]),b.factory("ParseAuth",["persist","ParseUser","ParseUtils","$q",function(a,b,c,d){var e;return e={sessionToken:null,currentUser:null,_login:function(b){var c;return e.currentUser=b,e.sessionToken=b.sessionToken,c=b.attributes(),c.objectId=b.objectId,a.set({PARSE_USER_INFO:JSON.stringify(c),PARSE_SESSION_TOKEN:b.sessionToken}),b},resumeSession:function(){var c,f,g,h,i,j;if(g=a.get(["PARSE_SESSION_TOKEN","PARSE_USER_INFO"]),j=g.PARSE_USER_INFO,h=g.PARSE_SESSION_TOKEN,c=d.defer(),j&&h)try{i=new b(JSON.parse(j)),e.currentUser=i,e.sessionToken=h,c.resolve(i.refresh())}catch(k){f=k,c.reject("User attributes not parseable")}else c.reject("User attributes or Session Token not found");return c.promise},register:function(a,c){return new b({username:a,password:c}).save().then(function(a){return e._login(a)})},login:function(a,d){return c._request("GET","/login",null,{username:a,password:d}).then(function(a){return e._login(new b(a.data))})},logout:function(){return a.remove(["PARSE_SESSION_TOKEN","PARSE_USER_INFO"]),e.currentUser=null,e.sessionToken=null}}}]),b.factory("ParseModel",["ParseUtils",function(a){var b;return b=function(){function b(a){this.isDirty=d(this.isDirty,this),this._saveCache=d(this._saveCache,this),this.safeUpdateParse=d(this.safeUpdateParse,this),this.encodeParse=d(this.encodeParse,this),this.attributes=d(this.attributes,this),this.destroy=d(this.destroy,this),this.update=d(this.update,this),this.create=d(this.create,this),this.refresh=d(this.refresh,this),this.save=d(this.save,this),this.isNew=d(this.isNew,this);var b,c;for(b in a)c=a[b],this[b]=c;this.isNew()||this._saveCache()}return b.pathBase=function(){return"/classes/"+this.className},b.find=function(b,c){var d=this;return a._request("GET","/classes/"+this.className+"/"+b,null,c).then(function(a){return new d(a.data)})},b.query=function(b){var c=this;return a._request("GET",this,null,b).then(function(a){var b,d,e,f,g;for(f=a.data.results,g=[],d=0,e=f.length;e>d;d++)b=f[d],g.push(new c(b));return g})},b.configure=function(){var a,b;return b=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],this.className=b,this.attributes=a},b.prototype.isNew=function(){return!this.objectId},b.prototype.save=function(){return this.isNew()?this.create():this.update()},b.prototype.refresh=function(){var b=this;return a._request("GET",this).then(function(a){var d,e,f;f=a.data;for(d in f)c.call(f,d)&&(e=f[d],b[d]=e);return b})},b.prototype.create=function(){var b=this;return a._request("POST",this.constructor,this.encodeParse()).then(function(a){var c;return b.objectId=a.data.objectId,b.createdAt=a.data.createdAt,(c=a.data.sessionToken)&&(b.sessionToken=c),b._saveCache(),b})},b.prototype.update=function(){var b=this;return a._request("PUT",this,this.safeUpdateParse()).then(function(a){return b.updatedAt=a.data.updatedAt,b._saveCache(),b})},b.prototype.destroy=function(){var b=this;return a._request("DELETE",this).then(function(){return b.objectId=null,b})},b.prototype.attributes=function(){var a,b,c,d,e;for(b={},e=this.constructor.attributes,c=0,d=e.length;d>c;c++)a=e[c],b[a]=this[a];return b},b.prototype.encodeParse=function(){var a,b,c,d,e,f,g;for(c={},f=this.constructor.attributes,d=0,e=f.length;e>d;d++)a=f[d],a in this&&(b=this[a],null!=b&&b.objectId&&(null!=(g=b.constructor)?g.className:void 0)&&(b={__type:"Pointer",className:b.constructor.className,objectId:b.objectId}),c[a]=b);return c},b.prototype.safeUpdateParse=function(){var a,b,c,d,e;c=this.encodeParse();for(b in c)d=c[b],"number"==typeof d&&void 0!==(null!=(e=this._cache)?e[b]:void 0)&&(a=d-this._cache[b],0!==a?c[b]={__op:"Increment",amount:a}:delete c[b]);return c},b.prototype._saveCache=function(){return this._cache=angular.copy(this.encodeParse())},b.prototype.isDirty=function(){return!angular.equals(this._cache,this.encodeParse())},b}()}]),b.factory("ParseDefaultUser",["ParseModel",function(a){var b,c;return b=function(a){function b(){return c=b.__super__.constructor.apply(this,arguments)}return f(b,a),b.configure("users","username","password"),b.pathBase=function(){return"/users"},b.prototype.save=function(){return b.__super__.save.call(this).then(function(a){return delete a.password,a})},b}(a)}]),b.factory("ParseUser",["ParseDefaultUser","ParseCustomUser",function(a,b){return null!=b&&new b instanceof a?b:a}]),b.provider("Parse",function(){return{initialize:function(b,c){return a.apiKey=c,a.applicationId=b},$get:["ParseModel","ParseUser","ParseAuth","ParseUtils",function(a,b,c,d){return{BaseUrl:d.BaseUrl,Model:a,User:b,auth:c}}]}}),angular.module("Parse").factory("ParseCustomUser",["ParseDefaultUser",function(a){return a}])}).call(this);